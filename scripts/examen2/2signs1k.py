import sympy
from ecpy.curves import Curve

n = Curve.get_curve('secp521r1').order
f1 = 3588347413824068132377774488068246240603328165624202550958002472858373206346557447720992336915475549802930048639168727757082191720261590614999724478758990735

m = int("0x42c8f9abaa3be59e766ad44deeee3f7ea6c9e22f0361d72e7ba3400745481ef6ee9519c942ea9f05c3f8193dc2d5594b5a3def74e479bca33778b2263b41da2328", 16)
f2 = 6217822757392658945560927181838106577673023268049425581145540479917132926411480509905994558520818830752084969230283655477376598427321886441904642362018394697
m2 = int("0x1de7ed1f9c6307cc826492c59f790441837bb958c7de51882478df317ba53a2c741f08fbe13504ca4699ffa66a15761fbf3c162105cbb65be3fdfc2bf2aa12d77bb", 16)
f22 = 5299572456870336274705506837533416828887319391853343605472349589679005651631815121020752745492797656930993993510232461352871749206396876829087571418650909217



k = (sympy.mod_inverse(f2-f22, n) * (m-m2)) % n
print('k = ', k)
print('-------------------')
d = (f2 * k - m) * sympy.mod_inverse(f1,n) % n
print('d = ', d)
